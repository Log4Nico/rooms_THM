<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>MemLabs - 6 - Writeup Log4Nico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <div class="container">
        <h1>MemLabs - 6 - Write-Up</h1>
        <p>En este write-up, me adentro en los retos de <a href="https://github.com/stuxnet999/MemLabs">MemLabs</a>, una serie de laboratorios diseñados para poner a prueba 
          nuestras habilidades en el análisis de volcados de memoria. Equipado con <b>Volatility</b>, una de las herramientas 
          más potentes para diseccionar sistemas vivos o caídos, iré desenterrando credenciales, procesos sospechosos, 
          conexiones de red y cualquier pista que hayan dejado atrás.</p>

        <p>El momento ha llegado, damos pie al último reto, el más complicado del desafío, <a href="https://github.com/stuxnet999/MemLabs/tree/master/Lab%206">MemLabs Lab 6 - The Reckoning</a></p>

        <h2>Enunciado</h2>

        <p>Recibimos este volcado de memoria del Departamento de Inteligencia. Dicen que esta evidencia podría contener secretos del mafioso del bajo mundo, 
          David Benjamin. Este volcado fue extraído de uno de sus trabajadores, a quien el FBI detuvo a principios de esta semana.
          Tu tarea es revisar el volcado de memoria y ver si puedes descubrir algo. El FBI también comenta que David se comunicaba con sus trabajadores por internet, 
          así que podría ser un buen punto de partida.</p>
        
        <h2>¿Qué sacamos en claro?</h2>
        <ul>
          <li>David se comunicaba por internet.</li>
        </ul>

        <p>Además, este reto solo tiene 1 flag dividia en 2.</p>

        <h2>Análisis del perfil</h2>
        
        <p>Para sacar la memoria debemos usar el siguiente comando:</p>

        <code>vol.py -f MemoryDump_Lab6.raw imageinfo</code>

        <img src="img/image.png" alt="perfil">

        <p>Como ya he dicho varias veces, podemos usar cualquira que nos salga.</p>
        
        <h2>Análisis de la memoria</h2>
        
        <h3>Internet</h3>

        <p>Cuando hablamos de <i>internet</i>, lo que primero que se nos viene a la cabeza es el historial del navegador, así que empecemos por ahí.</p>

        <p>Lo primero que haré es ver si el archivo del historial está cargado en la memoria con <b>filescan</b>:</p>

        <img src="img/image-1.png" alt="historial">

        <p>Ahora podemos pasar a exportar el archivo con <b>dumpfiles</b> y abrirlo con sqlitebrowser:</p>

        <img src="img/image-2.png" alt="extraer historial">

        <p>Y para ver las páginas a las que accedió, seguimos los siguientes pasos:</p>

        <img src="img/image-3.png" alt="ver historial">

        <p>Lo único <i>extraño</i> que veo, es el siguiente link de <b>pastebin</b>, aplicación web que funciona como un <i>portapapeles</i> en línea</p>

        <img src="img/image-4.png" alt="pastebin">

        <img src="img/image-5.png" alt="contenido pastebin">

        <p>El enlace a google documents, nos lleva a un documento lleno de frases en latin, pero, escondido en los parrafos, encontramos otra URL al sitio <b>mega</b>:</p>
        
        <img src="img/image-6.png" alt="contenido documento">

        <p>Desgraciadamente, el archivo está encriptado por contraseña, contraseña que aún no tenemos. Dejamos el enlace a mega apartado y seguimos buscando.</p>
        
        <img src="img/image-7.png" alt="mega cifrado">

        <p>Usando <b>hashdump</b>, encontramos 2 usuarios en el sistema: <i>Jaffa</i> y <i>g4rud4</i>.</p>

        <img src="img/image-8.png" alt="usuarios">

        <p>En el directorio de <i>g4rud4</i> no hay nada interesante, a diferencia del de <i>Jaffa</i>, en el cual podemos encontrar una flag protegida:</p>

        <img src="img/image-9.png" alt="escritorio Jaffa">

        <img src="img/image-10.png" alt="protected flag">

        <p>Al intentar descomprimir no nos da ninguna pista, pero asumo que está escondida en la memoria, veamos si las variables de entorno guardan algo interesante:</p>

        <img src="img/image-11.png" alt="contraseña rar">

        <p>Efectivamente, encontramos la contraseña del archivo comprimido así como la segunda mitad flag, pero aún nos queda la primera.</p>

        <p>Podemos intentar usar el módulo <b>screenshot</b>, el cual nos devuelve imágenes de los últimos momentos de la extracción de la memoria:</p>

        <img src="img/image-12.png" alt="screenshot">

        <p>No sacamos nada así.</p>

        <p>Lo único que se me ocurre es hacer un <b>strings</b> de la memoria completa filtrando con <i>Mega Drive</i>:</p>

        <pre>El comando <i>strings</i> se utiliza para ver las líneas <i>leibles</i> de un archivo, independintemente de la extensión.</pre>
        <pre>Es como si abriesemos un archivo con el blog de notas y solo nos quedaramos con las palabras que entendemos.</pre>

        <img src="img/image-13.png" alt="The Key is ...">

        <p>Tenemos el archivo, problema, no se abre, solución, los números mágicos no son correctos, los editamos con cualquier edito hexadecimal, y tandríamos la solución al desafío:</p>

        <img src="img/image-14.png" alt="números mágicos">
        <pre>Según Wikipedia, el hexadecimal de los archivos png deben empezar con esos números.</pre>

        <img src="img/image-15.png" alt="primera flag">
        <img src="img/image-16.png" alt="segunda flag"> 

        <p>Con este último reto concluyo la serie completa de MemLabs, un conjunto de desafíos centrados en el análisis forense de memoria RAM
           que me han permitido profundizar y consolidar conocimientos clave en el uso de herramientas como Volatility.</p>

        <p>Durante el proceso he tenido la oportunidad de enfrentarme a escenarios realistas, aprender a interpretar artefactos de memoria,
           identificar actividad sospechosa y afinar el enfoque analítico necesario para este tipo de investigaciones. 
           Cada write-up que he realizado refleja no solo la solución técnica, sino también el aprendizaje detrás de cada caso.</p>

        <p>Agradezco el esfuerzo de quienes desarrollaron estos retos: su calidad y variedad los convierten en una excelente referencia para quienes 
          quieran introducirse o avanzar en el mundo del memory forensics.</p>

        <a href="../Memlabs - Lab 5/index.html">Ir al laboratorio anterior</a> <br>
    </div>
</body>
</html>
