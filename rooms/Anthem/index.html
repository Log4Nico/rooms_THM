<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Anthem - Writeup Log4Nico</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <div class="container">
    <h1>Anthem</h1>

    <div class="section">
      <h2>Análisis</h2>
      <p>Empezamos el análisis con un escaneo de puertos simple:</p>
      <img src="img/image.png" alt="Escaneo de puertos">

      <p>Vemos un servicio web en el puerto <strong>80</strong>, y un escritorio remoto en el <strong>3389</strong>.</p>
      <p>Si entramos en el servicio web, apreciamos una especie de blog personal:</p>
      <img src="img/image-1.png" alt="Blog personal">

      <p>Metiéndome en enlaces del propio blog, he sacado esta flag:</p>
      <img src="img/image-2.png" alt="Flag 3">
      <span class="flag">THM{L0L_WH0_D15}</span>

      <img src="img/image-3.png" alt="Poema">
      <blockquote>Un poema(?)<br>Parece que es muy conocido en CTFs</blockquote>

      <img src="img/image-4.png" alt="Flag 2">
      <span class="flag">THM{G!T_G00D}</span>

      <p>Y poco más, voy a hacer un fuzzeo a ver qué sale:</p>
      <img src="img/image-5.png" alt="Fuzzeo fallido">
      <blockquote>Me he cargado gobuster(?)</blockquote>

      <p>Mis herramientas de fuzzeo parece que no funcionan, pruebo con los directorios típicos y sale esto:</p>
      <img src="img/image-6.png" alt="CMS Umbraco">
      <blockquote>Lo que parece una contraseña<br>El CMS <em>umbraco</em></blockquote>

      <img src="img/image-7.png" alt="Login Umbraco">

      <p>Esto nos redirige a un login, tenemos la contraseña, falta el usuario:</p>
      <img src="img/image-8.png" alt="Intentos de usuario">
      <blockquote>No es ni este, ni otro que he deducido usando la misma lógica: jh@anthem.com</blockquote>

      <p>La única pista que tengo es el poema de antes, chatGPT dice que se trata de un poema de <em>Solomon Grundy</em> (sg@anthem.com)(?)</p>
      <img src="img/image-9.png" alt="Poema Grundy">
      <blockquote>Un poco rebuscado la verdad...</blockquote>
    </div>

    <div class="section">
      <h2>Búsqueda de Flags en la Web</h2>
      <p>Ya encontré 2 antes, las pongo aquí:</p>
      <img src="img/image-2.png" alt="Flag 3">
      <span class="flag">flag 3: THM{L0L_WH0_D15}</span>
      <img src="img/image-4.png" alt="Flag 2">
      <span class="flag">flag 2: THM{G!T_G00D}</span>

      <p>Para el resto, parece que vamos a tener que seguir buscando.</p>
      <img src="img/image-10.png" alt="Flag 1">
      <span class="flag">flag 1: THM{L0L_WH0_US3S_M3T4}</span>
      <br>
      <img src="img/image-11.png" alt="Flag 4">
      <br>
      <span class="flag">flag 4: THM{AN0TH3R_M3TA}</span>

      <blockquote>Literalmente, todas las flags se pueden encontrar desde un principio, solo hay que inspeccionar el código fuente de la página.</blockquote>
    </div>

    <div class="section">
      <h2>Escalada de Privilegios</h2>
      <p>En el análisis de puertos, vimos que el servidor tiene un escritorio remoto, vamos a intentar iniciar sesión con las credenciales que tenemos:</p>
      <img src="img/image-13.png" alt="Intento RDP">
      <blockquote>Claro, así da error, un usuario de windows no puede tener un dominio de correos, poner solo sg en el campo usuario.</blockquote>
      <img src="img/image-12.png" alt="Sesión RDP">

      <p>Ya hemos iniciado sesión con un usuario normal en la máquina, y en el escritorio tenemos la primera flag:</p>
      <img src="img/image-14.png" alt="Flag usuario">

      <p>THM nos da una pista para encontrar la contraseña del administrador: <em>It is hidden</em>, pruebo a mostrar los archivos ocultos desde el explorador:</p>
      <img src="img/image-15.png" alt="Archivos ocultos">
      <img src="img/image-16.png" alt="Carpeta oculta">

      <p>Encontramos un archivo en una carpeta oculta, pero no podemos abrirlo por temas de permisos.</p>
      <img src="img/image-17.png" alt="Permisos archivo">

      <blockquote>Nadie tiene permisos para ver/editar el archivo(OK), lo editamos y añadimos a SG:</blockquote>
      <img src="img/image-18.png" alt="Editar permisos">
      <img src="img/image-19.png" alt="Contraseña root">
      <span class="flag">Contraseña del root: ChangeMeBaby1MoreTime</span>

      <p>Ahora podríamos cerrar sesión SG e iniciar con Administrator:</p>
      <img src="img/image-20.png" alt="Inicio sesión admin">
      <span class="flag">ChangeMeBaby1MoreTime</span>

      <blockquote>Y ya estaría, una forma extraña de escalar privilegios.</blockquote>
    </div>
  </div>
</body>
</html>
